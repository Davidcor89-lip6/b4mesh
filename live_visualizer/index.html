<!doctype html>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<meta name="viewport" content="width=device-width, initial-scale=1">
<html>
    <title>Blockgraph live visualizer</title>
    <head>
        <link rel="icon" href="favicon.ico" />
        <link rel="stylesheet" href="style.css">
        <script src="//d3js.org/d3.v5.min.js"></script>
        <script src="https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js"></script>
        <script src="https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js"></script>
        <script src="scripts/json_to_dot_cluster.js"></script>
        <script src="scripts/json_to_dot_time.js"></script>
        <script src="scripts/string_hash.js"></script>
        <script src="scripts/view_operations.js"></script>
        <script src="configuration.js"></script>
        <link
          href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700&display=swap"
          rel="stylesheet"
        />    
        <script
        src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
        crossorigin="anonymous"></script>
    </head>
    <body>
        <nav class="navbar">
          <ul class="navbar-nav">
            <li class="nav-item arrow">
              <button class="btn-tlb" onclick="orientation_change()">
              <a href="#" class="nav-link tooltiparr"> <span class="tooltiptext">Change orientation</span>
                
                <svg aria-hidden="true"
                  id="arr"
                  color ="green"
                  focusable="false" 
                  data-prefix="fas" 
                  data-icon="arrow-right" 
                  class="svg-inline--fa fa-arrow-right fa-w-14" 
                  role="img" 
                  xmlns="http://www.w3.org/2000/svg" 
                  viewBox="0 0 448 512">
                  <path fill="currentColor" 
                  d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z">
                </path>
              </svg>
                
              </a>
            </button>

            </li>
            <li class="nav-item  sep">
              <button class="btn-tlb"  onclick="alternate()">
              <a href="#" class="nav-link tooltip"> <span class="tooltiptext">Change view</span>
                <svg
                  color="white"
                  class="yo"
                  aria-hidden="true"
                  focusable="false"
                  data-prefix="fas"
                  data-icon="project-diagram"
                  class="svg-inline--fa fa-project-diagram fa-w-20 "
                  role="img"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 640 512"
                >
                  <path
                    fill="currentColor"
                    d="M384 320H256c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h128c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32zM192 32c0-17.67-14.33-32-32-32H32C14.33 0 0 14.33 0 32v128c0 17.67 14.33 32 32 32h95.72l73.16 128.04C211.98 300.98 232.4 288 256 288h.28L192 175.51V128h224V64H192V32zM608 0H480c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h128c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32z"
                  ></path>
                </svg>
                
              </a>
              
            </button>
            </li>
            <li class="nav-item sep">
              <button class="btn-tlb" id="reset_zoom_button">
              <a href="#" class="nav-link tooltip"><span class="tooltiptext">Reset position</span>
                <svg 
                aria-hidden="true"
                 focusable="false" 
                 data-prefix="fas" 
                 data-icon="compress-arrows-alt" 
                 class="svg-inline--fa fa-compress-arrows-alt fa-w-16" 
                 role="img" 
                 xmlns="http://www.w3.org/2000/svg" 
                 viewBox="0 0 512 512">
                 <path fill="currentColor" 
                 d="M200 288H88c-21.4 0-32.1 25.8-17 41l32.9 31-99.2 99.3c-6.2 6.2-6.2 16.4 0 22.6l25.4 25.4c6.2 6.2 16.4 6.2 22.6 0L152 408l31.1 33c15.1 15.1 40.9 4.4 40.9-17V312c0-13.3-10.7-24-24-24zm112-64h112c21.4 0 32.1-25.9 17-41l-33-31 99.3-99.3c6.2-6.2 6.2-16.4 0-22.6L481.9 4.7c-6.2-6.2-16.4-6.2-22.6 0L360 104l-31.1-33C313.8 55.9 288 66.6 288 88v112c0 13.3 10.7 24 24 24zm96 136l33-31.1c15.1-15.1 4.4-40.9-17-40.9H312c-13.3 0-24 10.7-24 24v112c0 21.4 25.9 32.1 41 17l31-32.9 99.3 99.3c6.2 6.2 16.4 6.2 22.6 0l25.4-25.4c6.2-6.2 6.2-16.4 0-22.6L408 360zM183 71.1L152 104 52.7 4.7c-6.2-6.2-16.4-6.2-22.6 0L4.7 30.1c-6.2 6.2-6.2 16.4 0 22.6L104 152l-33 31.1C55.9 198.2 66.6 224 88 224h112c13.3 0 24-10.7 24-24V88c0-21.3-25.9-32-41-16.9z">
                </path>
                </svg>
                <div class="link-text tooltip"  >reset zoom</div>
              </a>
            </button>
            </li>
            <li class="nav-item sep tooltip"> <span class="tooltiptext">Change view</span>
              <button  class="btn-tlb" id="auto_cam" >
              <a href="#" class="nav-link tooltip"  id="auto"> <span class="tooltiptext">Automate camera</span>
                <svg 
                id ="camera"
                color="red"
                aria-hidden="true" 
                focusable="false" 
                data-prefix="fas" 
                data-icon="video" 
                class="svg-inline--fa fa-video fa-w-18" 
                role="img" 
                xmlns="http://www.w3.org/2000/svg" 
                viewBox="0 0 576 512">
                <path fill="currentColor" 
                d="M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z"></path>
                </svg>
              
              </a>
              </button>
            </li>
          </ul>
        </nav>

        <main>
          <div class="header">
            <h1 class="title">B4MESH </h1>

          </div>
          <div class="menu"> 
            <ul class="links">
              <li class="link-container">
                <a class="menu-link"  href="#"> 
                  <svg 
                  aria-hidden="true" 
                  focusable="false" 
                  data-prefix="fas" 
                  data-icon="home" 
                  class="svg-inline--fa fa-home fa-w-18" 
                  role="img" 
                  xmlns="http://www.w3.org/2000/svg" 
                  viewBox="0 0 576 512">
                  <path fill="currentColor" 
                  d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path>
                </svg>
                <span>Home</span>
                </a>
              </li>
              <li class="link-container">
                <a class="menu-link" href="#">
                  <svg 
                  aria-hidden="true" 
                  focusable="false" 
                  data-prefix="far" 
                  data-icon="eye" 
                  class="svg-inline--fa fa-eye fa-w-18" 
                  role="img" 
                  xmlns="http://www.w3.org/2000/svg" 
                  viewBox="0 0 576 512">
                  <path fill="currentColor" 
                  d="M288 144a110.94 110.94 0 0 0-31.24 5 55.4 55.4 0 0 1 7.24 27 56 56 0 0 1-56 56 55.4 55.4 0 0 1-27-7.24A111.71 111.71 0 1 0 288 144zm284.52 97.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400c-98.65 0-189.09-55-237.93-144C98.91 167 189.34 112 288 112s189.09 55 237.93 144C477.1 345 386.66 400 288 400z"></path>
                  </svg>
                    <span >Visualisation</span>
                </a>
              </li>
              <li class="link-container">
                <a class="menu-link" href="dashboard.html">
                  <svg
                    color="green"
                    version="1.1"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    x="0px"
                    y="0px"
                    viewBox="0 0 1000 1000"
                    enable-background="new 0 0 1000 1000"
                    xml:space="preserve"
                  >
                    <metadata>
                      Svg Vector Icons : http://www.onlinewebfonts.com/icon
                    </metadata>
                    <g>
                      <path
                        fill="currentColor"
                        d="M950.5,742.8c-113.5-0.5-227.1-0.3-340.6-0.3h-18c1.6,23.1,3.7,45.2,4.6,67.4c1.2,28.6,14.6,48.6,39.5,61.9c10.1,5.4,19.8,11.6,29.5,17.7c2.9,1.8,6,3.9,8,6.6c5.5,7.6,1.9,14.6-7.6,14.8c-14.7,0.3-29.3,0.1-44,0.1c-94.4,0-188.8,0-283.2-0.1c-5.5,0-12.5,1.7-14.4-5.8c-1.8-7.3,3.2-11.8,9-15.2c12.6-7.5,25.2-15,37.7-22.6c19.3-11.8,29.9-29,31.6-51.6c1.8-23.8,3.6-47.7,5.5-73.1h-12.4c-116.4,0-232.8,0-349.2,0c-25.4,0-36.6-11.2-36.6-36.8c0-180.2,0-401.2,0-581.4c0-23,11.8-35.1,34.5-35.1c302,0,604,0.1,906-0.3c18.8,0,32,5.8,39.5,23.2v607.4C982.5,736.9,969.3,742.9,950.5,742.8z M943.4,156.3H56.5v514.3h886.9V156.3z M117.2,520.2c0-11.4,0.1-22.9,0-34.4c-0.1-8.6,3.7-13.2,12.5-13.2c13,0,26.1,0.1,39.1,0c8.8-0.1,12.8,4.6,12.9,13c0.1,23.5,0.1,47.1,0,70.6c0,8.5-4.2,12.9-13,12.8c-12.7-0.1-25.5,0.1-38.2-0.1c-9.5-0.1-13.1-3.9-13.2-13.5C117.1,543.7,117.2,531.9,117.2,520.2L117.2,520.2z M302.9,503.9c0-16.6-0.1-33.1,0-49.7c0.1-10.2,3.5-13.6,13.8-13.7c12.4-0.1,24.8-0.1,37.3,0c9.6,0.1,13.4,3.6,13.4,13.3c0.2,34.1,0.1,68.1,0,102.2c0,8.4-4.2,13-13,12.9c-12.7-0.1-25.5,0.1-38.2-0.1c-9.5-0.1-13.2-3.9-13.3-13.4C302.8,538.3,302.9,521.1,302.9,503.9z M274.3,488.5c0,22,0.1,44,0,65.9c0,11.1-3.2,14.3-14.1,14.5c-12.1,0.1-24.2,0.1-36.3,0c-9.9-0.1-13.6-3.3-13.7-12.9c-0.2-44.9-0.2-89.8,0-134.8c0-9.7,3.7-12.9,13.6-13c12.4-0.1,24.9-0.1,37.3,0c9.6,0.1,13.1,3.7,13.1,13.4C274.4,443.9,274.3,466.2,274.3,488.5z M847.3,313.1c-40.2,30.1-79.9,59.9-120.8,90.5V248.5C763.1,244.9,825.9,278.2,847.3,313.1z M395.9,473.3c0-27.1,0-54.2,0-81.3c0-13.2,3.1-16.1,16.4-16.2c11.2,0,22.3-0.1,33.5,0c10.3,0.1,14.1,3.6,14.1,13.5c0.1,55.5,0.1,110.9,0,166.4c0,9.5-3.8,13-13.5,13.2c-12.4,0.2-24.9,0.1-37.3,0c-9.5-0.1-13.1-3.6-13.2-13.4C395.9,528.1,396,500.7,395.9,473.3L395.9,473.3z M334.4,371.8c29.9-34,59.5-67.6,90.8-103.1c-13.8,0-25.1-0.2-36.4,0.1c-7.6,0.2-13.5-1.9-14.2-10.5c-0.6-6.9,5-10.9,14.7-10.9c18.8,0,37.6-0.1,56.4,0c11,0.1,14.3,3.2,14.3,14.2c0.1,19.4-0.1,38.9,0.1,58.3c0.1,7.5-2.9,13-10.6,13c-7.7,0-10.9-5.3-10.8-12.9c0.1-10.4,0-20.8,0-33.8c-4.6,5-7.8,8.3-10.8,11.8c-27,30.6-53.9,61.3-80.9,91.8c-8.5,9.6-12.2,9.9-22.4,1.8c-27.2-21.6-54.3-43.3-82-65.5c-2.6,2.3-5.2,4.4-7.7,6.8c-31.1,29.3-62.2,58.5-93.3,87.8c-2.3,2.2-4.5,4.5-7.1,6.4c-5.1,3.7-11.2,3.8-14.2-1.5c-2-3.5-1-9.2-0.1-13.7c0.5-2.3,3.8-4.1,5.9-6.1c34.8-32.8,69.6-65.6,104.4-98.3c9.3-8.7,12.1-8.8,22-0.9c24.4,19.5,48.8,39,73.2,58.5C328.5,367.3,331.3,369.4,334.4,371.8z M814.3,549c-26.7-41.4-53.4-82.8-80.5-124.7c42.1-31.5,83.5-62.5,125-93.6C901,393.8,888,497.5,814.3,549z M704.8,260.3c0,31,0,61.2,0,91.5c0,19.1-0.3,38.3,0.2,57.4c0.1,4.8,1.5,10.1,4.1,14.1c23.7,37.4,47.9,74.5,71.8,111.7c2.9,4.5,5.8,9,8.7,13.5c-42.6,27.1-111.8,30.2-165.4-8.6c-54.5-39.4-77.6-108.7-57.4-172.2C586.2,306.4,644,261.1,704.8,260.3z"
                      />
                    </g>
                  </svg>
                <span>Dashboard</span>
                
                </a>
              </li>
            </ul>
          </div>

          <div class="toolbar">
              <div class="h100">
                <div class="card_top">
                  Blockgraph live visualizer
                  <ul class="infos">
              
                    <div class="informations">
                      <div class="toolbar_element">
                        <span class="information_label">Blocks</span>
                        <span class="information_value" id=view_nodes_count>0</span>
                      </div>
                      <div class="toolbar_element">
                        <span class="information_label">Clusters</span>
                        <span class="information_value" id=view_clusters_count>0</span>
                      </div>
                    </div>
                  </ul>
                </div>
            
      <!-- Graph -->
              <div id="graph-container" class="graph_container">
                
              </div>
            </div>
          </div>

       
        </main>
        <div class="footer">
          <p class="footer_element footer_txt">Consortium </p>
          <div class="footer_element">
            <img class="footer_pic" src="img_web/logo_green_com.png" alt="green communication">
            <img class="footer_pic sorb" src="img_web/logo_sorbonne.png" alt="sorbonne universitÃ©">
            <img class="footer_pic squad " src="img_web/Squad.png" alt="squad">
          </div>
        </div>
            
        <script type="text/javascript">
        
            // [todo] Rendering stability
            //  https://gist.github.com/magjac/28a70231e2c9dddb84b3b20f450a215f
            //  - cache dot graph
            //  - call renderDot(cache) instead of render()
            //  - add events renderDot(cache).on("end", funct(){})

            // options management

            

        // Style Toolbar 
            var options ="LR";

            var deg=90;
            var x, i, j, l, ll, selElmnt, a, b, c;
            var auto_on=false
            var viewbchain =true
           function alternate(){
                if(viewbchain){
                viewbchain=false;
                }else if(!viewbchain){
                  viewbchain=true;
                }
                fetch(new Request(configuration.blockgraph_as_dot_API_accesspoint), {cache: "reload"}).then(function(reponse) {
                    return reponse.text();
                }).then(data => {    draw_fetched_datas(data)})            
            }

            const graphContainer = d3.select("#graph-container");
            var rendering = graphContainer
                .graphviz()
                .transition(function () {
                    return d3.transition("main")
                        .ease(d3.easeLinear)
                        .delay(40)
                        .duration(750);
                })
                .width(graphContainer.node().clientWidth)
                .height(graphContainer.node().clientHeight)
                //.zoom(true)
                .fit(true)
                ;
            console.log(rendering)
            var update_views = function(){
                document.getElementById("view_nodes_count").innerHTML = d3.select(".graph").selectAll(".node").nodes().length;
                // probably temporary
                if(view==1){
                    document.getElementById("view_clusters_count").innerHTML = d3.select(".graph").selectAll(".cluster").nodes().length;
                    //console.log(d3.select(".graph").selectAll(".cluster");
                }           
            };

            let freshest_node_type = class {
                hash = null;
                get node() {
                    var node_hash = this.hash;
                    var value = d3.selectAll('.node').nodes().filter(
                        function(d, i){
                            return d3.select(d).select('title').node().textContent == node_hash;
                        }
                    );
                    return value.length == 0 ? null : value[0];
                }
                center_node() {
                    // no rendering here, only centering
                    if (freshest_node.node == null)
                        return;
                    center_element(freshest_node.node);
                    // rendering.render();
                }
            };
            freshest_node = new freshest_node_type();

            var render_graph = function(datas) {

               // const is_camera_automated = document.getElementById('automate_camera').checked;

                rendering
                    .renderDot(datas)
                    .on("end", function(){
                        update_views();
                        if (auto_on)
                        {
                            freshest_node.center_node();
                            //rendering.render();
                        }
                    
                        d3.selectAll(".node").on("click", function(){
                            console.log('Focusing node : ' + d3.select(this).selectAll('title').text());
                            center_element(this);
                            rendering.render();
                        });
                        d3.selectAll(".node").on("dblclick", function(){
                            console.log('Focusing node : ' + d3.select(this).selectAll('title').text());
                            center_and_zoom_element(this);
                            rendering.render();
                        });
                        // d3.selectAll('.cluster').on("mouseenter", function() {
                        //     var this_polygon = d3.select(this).select('polygon').node();
                        //     this_polygon.style.strokeWidth = 3;
                        //     this_polygon.style.stroke = "darkslateblue";
                        // });
                        // d3.selectAll('.cluster').on("mouseleave", function() {
                        //     var this_polygon = d3.select(this).select('polygon').node();
                        //     this_polygon.style.strokeWidth = 1;
                        //     this_polygon.style.stroke = "black";
                        // });
                    });
            }
            var view=0
            var datas_as_dot = null;
            var draw_fetched_datas = function(datas_as_json)
            {
                try
                {  
                   // console.log(graph_option_html_references.orientation_node[0].getAttribute("data-orientation"))
                    // probably temporary
                    if(viewbchain){
                        datas_as_dot = json_to_dot_time(datas_as_json, options);
                        document.getElementById("view_clusters_count").innerHTML = nb_cluster();
                    }else if ( !viewbchain){
                        datas_as_dot = json_to_dot_cluster(datas_as_json, options);
                        

                    }
                    
                    // console.log("json_to_dot : [\n" + datas_as_dot + "\n]")
                }
                catch (error) {
                    console.error('[draw_fetched_datas] Error : graph rendering failed : ' + error)
                    throw(error);
                }

                try {
                    if (document.hidden)
                    {   // Check if rendering is useless ...
                        console.log('[draw_fetched_datas] Tab is not focused, canceling datas update ...')
                        return; // do not update if the tab is inactive
                    }
                    render_graph(datas_as_dot);
                }
                catch (error) { console.error('[error](rendering) graph rendering failed : ' + error) }

                try
                {   // refresh `freshest_node` value
                    var lines = datas_as_json.split('\n');
                    const regex = /\"hash\"\:(\d+)\,/;
                    if (lines.length == 0)
                        return;
                    var freshest_node_hash = null;
                    if (lines[lines.length - 1].length == 0 && lines.length > 1)
                        freshest_node_hash = lines[lines.length - 2].match(regex)[1];
                    else freshest_node_hash = lines[lines.length - 1].match(regex)[1];

                    freshest_node.hash = freshest_node_hash;
                }
                catch (error)
                {
                    console.log("Cannot update freshest_node_hash, datas seems to be invalid");
                }
            }

            if (!window.Worker)
                throw('[poll_worker] Error : Browser does not support workers');

            var worker = function(){
                // fix Chrome security error (Firefox allow local files, not Chrome)
                const poll_worker_task_URL = function() {
                    var url = new URL(window.location.href);
                    url.search = "";
                    url.pathname = "scripts/poll_worker_task.js";
                    return url;
                }();
                return new Worker(poll_worker_task_URL.toString());
            }();

            // events
            worker.onmessage = function(event) {
                //console.log("worker.onmessage ... [\n" + event.data + "\n]")
                draw_fetched_datas(event.data);
                // todo : auto-focus on last element
            };

            

           worker.onerror = function(event){
                console.log("[error](polling) worker error : " + event.message);
            };
            document.onvisibilitychange = function() {
                if (document.hidden || datas_as_dot == null)
                    return;
                render_graph(datas_as_dot); // force rendering on tab selection
            };
            window.onerror = function myErrorHandler(msg, url, lineNumber) {
                //alert("Error : " + msg);
                return false;
            }   
            
            window.onresize = function() {
                console.log('window resized to [' + window.innerWidth + 'x' + window.innerHeight + ']');
                if (rendering.data() === null)
                    return; // not initialized yet
                rendering
                    .width(graphContainer.node().clientWidth)
                    .height(graphContainer.node().clientHeight)
                    .fit(true)
                    .render();
            };
           
            document.getElementById('reset_zoom_button').onclick  = function(event){
                if (d3 === null || rendering === null)
                    return;
                rendering.resetZoom(d3.transition().duration(1000));
            };

            var vision = document.getElementsByClassName('mode');
            var lvision = vision.length;

           /*Movement arrow on and click and orientation change*/ 
          
          function  orientation_change(){
            
            if (options=="LR"){
              
              document.getElementById("arr").style.transform = "rotate("+deg+"deg)"
              options="TD";
              deg+=90
            }
            else if(options=="TD"){
              document.getElementById("arr").style.transform = "rotate("+deg+"deg)"
              options="RL";
              deg+=90
            }
            else if(options=="RL"){
              document.getElementById("arr").style.transform = "rotate("+deg+"deg)"
              options="BT";
              deg+=90
            }
            else if(options=="BT"){
              document.getElementById("arr").style.transform = "rotate("+deg+"deg)"
              options="LR";
              deg+=90              
            }

                // temporary worker.onmessage event disable
                worker._onmessage = worker.onmessage;
                worker.onmessage = function(event){};

                const regex = /rankdir=\w\w\;/g;

                datas_as_dot = datas_as_dot.replaceAll(regex, 'rankdir='+options+';');
                rendering.resetZoom(d3.transition().duration(1000));
                render_graph(datas_as_dot);

                worker.onmessage = worker._onmessage;
                worker._onmessage = null;
          }

          document.getElementById("auto").addEventListener('click', function(){
            if(auto_on){
              document.getElementById("camera").style.color="";
              auto_on=false;
            }
            else{
              document.getElementById("camera").style.color="red";
              auto_on=true;
            }
            ;
          })
        </script>
    </body>
</html>